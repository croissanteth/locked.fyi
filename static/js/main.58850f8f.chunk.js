(this["webpackJsonplocked.fyi"]=this["webpackJsonplocked.fyi"]||[]).push([[0],{1104:function(e,t){},1178:function(e,t){},1206:function(e,t){},1385:function(e,t){},1487:function(e,t){},1505:function(e,t){},1532:function(e,t){},1615:function(e,t){},1617:function(e,t){},1626:function(e,t){},1627:function(e,t){},1691:function(e,t){},1769:function(e,t){},1778:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n.n(a),c=n(408),o=n.n(c),i=(n(744),n(137)),l=n(97),u=n(26),s=n(729),d=n.n(s),m=n(406),f=(n(764),function(){return r.a.createElement("svg",{style:{margin:10,width:20},viewBox:"0 0 105 105",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("circle",{cx:"12.5",cy:"12.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"0s",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"12.5",cy:"52.5",r:"12.5",fillOpacity:".5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"100ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"52.5",cy:"12.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"300ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"52.5",cy:"52.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"600ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"92.5",cy:"12.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"800ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"92.5",cy:"52.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"400ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"12.5",cy:"92.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"700ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"52.5",cy:"92.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"500ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})),r.a.createElement("circle",{cx:"92.5",cy:"92.5",r:"12.5"},r.a.createElement("animate",{attributeName:"fill-opacity",begin:"200ms",dur:"1s",values:"1;.2;1",calcMode:"linear",repeatCount:"indefinite"})))}),b=n(0),p=n.n(b),v=n(34),E=n(89),h=n(76),y=n(188),g=n.n(y),k=n(136),w=n.n(k),j=function(e){return e.map((function(e){return Object(h.a)({},e,{note:w()(e.message)})})).sort((function(e,t){var n,a,r,c;return(null===(n=e.note)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.createdAt)<=(null===(r=t.note)||void 0===r||null===(c=r.attributes)||void 0===c?void 0:c.createdAt)}))},O=function(e){var t=(e.attributes.locks||[]).map((function(e){return'  - "'.concat(e,'"\n')})).join("");return"---\ncreatedAt: ".concat(e.attributes.createdAt||(new Date).getTime(),"\nupdatedAt: ").concat((new Date).getTime(),"\ntitle: ").concat(e.attributes.title,'\nauthor: "').concat(e.attributes.author,'"\nlocks:\n').concat(t,"\n---\n").concat(e.body)},x=function(e,t){switch(t.type){case"setNote":return Object(h.a)({},t.note);case"setAttribute":return{attributes:Object(h.a)({},e.attributes,Object(E.a)({},t.attribute,t.value)),body:e.body};case"setBody":return Object(h.a)({},e,{body:t.body})}return e},C=function(e){return{attributes:{title:"",locks:[],createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),author:"".concat(e)},body:""}},S=new m.Converter({tables:!0,simplifiedAutoLink:!0,strikethrough:!0,tasklists:!0}),N=function(e){var t,n,c=e.identity,o=function(e,t){var n=Object(a.useState)(!0),r=Object(u.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(null),l=Object(u.a)(i,2),s=l[0],d=l[1],m=Object(a.useState)(!1),f=Object(u.a)(m,2),b=f[0],E=f[1],h=Object(a.useState)(null),y=Object(u.a)(h,2),k=y[0],S=y[1],N=Object(a.useReducer)(x,C(e)),A=Object(u.a)(N,2),P=A[0],B=A[1];Object(a.useEffect)((function(){(function(){var n=Object(v.a)(p.a.mark((function n(){var a,r,c,i,l,u;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o(!0),e){n.next=4;break}return o(!1),n.abrupt("return");case 4:return n.next=6,g.a.openBox(e,window.ethereum);case 6:return a=n.sent,n.next=9,a.openSpace("locked");case 9:return r=n.sent,n.next=12,r.joinThread("fyi",{members:!0});case 12:return c=n.sent,d(c),n.t0=j,n.next=17,c.getPosts();case 17:n.t1=n.sent,i=(0,n.t0)(n.t1),(l=i[t])?(S(l.postId),u=w()(l.message),B({type:"setNote",note:u})):B({type:"setNote",note:C(e)}),o(!1);case 22:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[e,t]);var M=function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E(!0),!k){e.next=4;break}return e.next=4,s.deletePost(k);case 4:return e.next=6,s.post(O(P));case 6:t=e.sent,S(t),E(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var t=Object(v.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(!0),t.next=3,s.deletePost(k);case 3:B({type:"setNote",note:C(e)}),S(null),E(!1);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{setNoteAttribute:function(e,t){B({type:"setAttribute",attribute:e,value:t})},setNoteBody:function(e){B({type:"setBody",body:e})},thread:s,note:P,loading:c,save:M,postId:k,destroy:T,saving:b}}(c,e.note),i=o.thread,s=o.note,m=o.setNoteAttribute,b=o.setNoteBody,E=o.loading,h=o.save,y=o.destroy,k=o.saving,N=o.postId,A=Object(a.useState)("write"),P=Object(u.a)(A,2),B=P[0],M=P[1];if(E||!i)return r.a.createElement(f,null);var T="/".concat(c);return r.a.createElement("form",{className:"container",onSubmit:function(e){return e.preventDefault(),h(),!1}},r.a.createElement("p",null,"Feed ",r.a.createElement(l.b,{to:T},T)),r.a.createElement("label",{htmlFor:"title"},"Title "),r.a.createElement("input",{type:"text",id:"title",name:"title",value:null===(t=s.attributes)||void 0===t?void 0:t.title,onChange:function(e){m("title",e.target.value)}}),r.a.createElement("label",{htmlFor:"locks"},"Locks (coma-separated)"),r.a.createElement("input",{type:"text",id:"locks",name:"locks",value:null===(n=s.attributes)||void 0===n?void 0:n.locks,onChange:function(e){m("locks",e.target.value.split(/[\W]+/).filter((function(e){return!!e})))}}),r.a.createElement(d.a,{value:s.body,onChange:b,selectedTab:B,onTabChange:M,generateMarkdownPreview:function(e){return Promise.resolve(S.makeHtml(e))}}),!k&&r.a.createElement("button",{type:"submit"},"Save"),k&&r.a.createElement("span",null,"Saving"),N&&r.a.createElement("button",{type:"button",onClick:y},"Destroy"))},A=function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),r=n[0],c=n[1];return{identity:r,authenticate:function(){var e=Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=7;break}return e.next=3,window.ethereum.enable();case 3:t=e.sent,c(t[0]),e.next=8;break;case 7:alert("You need to use a browser with an injected web3 wallet!");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},P=r.a.createContext(null),B=function(e){var t=e.children,n=A(),a=n.authenticate,c=n.identity;return r.a.createElement(P.Provider,{value:c},r.a.createElement("h1",null,"Locked.fyi"),r.a.createElement("header",null,!c&&r.a.createElement("nav",null,r.a.createElement("button",{onClick:a},"Authenticate")),c&&r.a.createElement("nav",null,r.a.createElement("span",null,"You are ",c,"!")),r.a.createElement("nav",null,r.a.createElement(l.b,{to:"/write"},"Write"))),t)},M=function(e){var t=e.note,n=Object(a.useContext)(P);return n?r.a.createElement(N,{identity:n,note:t}):r.a.createElement(r.a.Fragment,null,"Please authenticate first")},T=function(e,t){var n=Object(a.useState)(null),r=Object(u.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(!0),l=Object(u.a)(i,2),s=l[0],d=l[1];return Object(a.useEffect)((function(){(function(){var t=Object(v.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.getThread("locked","fyi",e,!0);case 2:n=t.sent,o(j(n)),d(!1);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()})),{loading:s,thread:c}},F=function(e){var t=e.thread,n=e.address;return r.a.createElement("section",null,r.a.createElement("p",null,"Read notes for ",n),!t.length&&r.a.createElement("p",null,"No notes have been published for this lock yet!"),r.a.createElement("ul",null,t.map((function(e,t){var a=w()(e.message),c="/".concat(n,"/").concat(t);return r.a.createElement("li",{key:e.postId},r.a.createElement(l.b,{to:c},a.attributes.title))}))))},L=function(e){var t=e.address,n=T(t),a=n.thread;return n.loading?r.a.createElement(f,null):r.a.createElement(F,{thread:a,address:t})},D=n(737),I=function(e){var t=e.locks,n=e.children,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(a.useState)(!0),n=Object(u.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(!0),i=Object(u.a)(o,2),l=i[0],s=i[1],d=function(){window.unlockProtocol.loadCheckoutModal()};return Object(a.useEffect)((function(){if(!e||!e.length)return s(!1),void c(!1);var t=function(e){s("locked"===e.detail),c(!1)};return window.addEventListener("unlockProtocol",t),window.unlockProtocol.resetConfig({locks:e.reduce((function(e,t){return Object(h.a)({},e,Object(E.a)({},t,{}))}),{}),callToAction:{}}),function(){window.removeEventListener("unlockProtocol",t)}}),[e]),{loading:r,locked:l,unlock:d}}(t),o=c.locked,i=c.loading,l=c.unlock;return i?r.a.createElement(f,null):o?r.a.createElement("p",null,r.a.createElement("button",{onClick:l},"Unlock")):n},W=function(e){var t=e.address,n=function(e){var t=Object(a.useState)(!0),n=Object(u.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)({}),i=Object(u.a)(o,2),l=i[0],s=i[1];return Object(a.useEffect)((function(){(function(){var t=Object(v.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.a.getProfile(e.toString());case 2:n=t.sent,s(n),c(!1);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),{loading:r,profile:l}}(t),c=n.loading,o=n.profile;return c?r.a.createElement("span",null,"\xa0"):o.website?r.a.createElement("span",null,"By ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o.website},o.name)):o.name?r.a.createElement("span",null,"By ",o.name):r.a.createElement("span",null,"By ",t)},R=function(e){var t=e.address,n=e.note,c=T(t).thread,o=Object(a.useContext)(P),i=function(e,t){var n=Object(a.useState)(!0),r=Object(u.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(null),l=Object(u.a)(i,2),s=l[0],d=l[1];return Object(a.useEffect)((function(){if(e){var n=e[t],a=w()(n.message);d(a),o(!1)}}),[t,e]),{note:s,loading:c}}(c,n),s=i.note,d=i.error,m=i.loading;if(d)return r.a.createElement("p",null,d);if(m)return r.a.createElement(f,null);var b="/".concat(t),p="/write?note=".concat(n),v=o===s.attributes.author;return r.a.createElement("article",null,r.a.createElement(W,{address:s.attributes.author}),r.a.createElement(I,{locks:s.attributes.locks},r.a.createElement(D.Markdown,{markup:s.body})),r.a.createElement("footer",null,r.a.createElement("nav",null,"Back to ",r.a.createElement(l.b,{to:b},"Thread")),v&&r.a.createElement("nav",null,r.a.createElement(l.b,{to:p},"Edit"))))},U=function(){return r.a.createElement("p",null,r.a.createElement("a",{href:"https://locked.fyi/"},"Locked.fyi")," is a ",r.a.createElement("em",null,"decentralized blogging platform"),"! The content is stored on ",r.a.createElement("a",{href:"https://ipfs.io/"},"IPFS"),", through the use of ",r.a.createElement("a",{href:"https://3box.io/"},"3Box"),". Most importantly, it lets authors lock  their notes if they want to monetize them, using the ",r.a.createElement("a",{href:"https://unlock-protocol.com/"},"Unlock Protocol"),"!")};var z=function(e){var t=e.match;return r.a.createElement(L,{address:t.params.address})},J=function(e){var t=e.match;return r.a.createElement(R,{note:t.params.note,address:t.params.address})},Y=function(){var e=new URLSearchParams(Object(i.f)().search).get("note");return r.a.createElement(B,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/write"},r.a.createElement(M,{note:e})),r.a.createElement(i.a,{path:"/:address(0x[a-fA-F0-9]{40})/:note([0-9]+)",component:J}),r.a.createElement(i.a,{path:"/:address(0x[a-fA-F0-9]{40})",component:z}),r.a.createElement(i.a,{path:"/"},r.a.createElement(U,null))))};var H=function(){return r.a.createElement(l.a,null,r.a.createElement(Y,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var $=document.getElementById("root");$.hasChildNodes()?o.a.hydrate(r.a.createElement(H,null),$):o.a.render(r.a.createElement(H,null),$),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},308:function(e,t){},341:function(e,t){},739:function(e,t,n){e.exports=n(1778)},744:function(e,t,n){},855:function(e,t){},870:function(e,t){},881:function(e,t){},883:function(e,t){},951:function(e,t){},953:function(e,t){}},[[739,1,2]]]);